syntax = "proto3";

package storage;

option go_package = "github.com/lk2023060901/xdooria-proto-api/storage;storage";

// 物品基类 - 所有存储物品的公共字段
message ItemBase {
    int64 id = 1;           // 实例唯一ID (UID)
    uint32 config_id = 2;   // 配置ID（关联配置表）
    int64 created_at = 3;   // 获得时间（时间戳）
    int64 updated_at = 4;   // 最近更新时间（时间戳）
    uint64 expire_at = 5;   // 过期时间（时间戳，0表示永久）
    int64 count = 6;        // 数量（堆叠用，非堆叠为1）
    bool is_favorite = 7;   // 是否收藏
}

// 普通道具存储
message StoredItem {
    ItemBase base = 1;
}

// 道具背包
message ItemBag {
    repeated StoredItem items = 1;
}

// 道具变化 - 数量变化的道具
message ItemChanged {
    int64 id = 1;           // 实例ID
    int64 count = 2;        // 当前数量（变化后的最新值）
    int64 updated_at = 3;   // 更新时间
}

// 道具变化 - 删除的道具
message ItemDeleted {
    int64 id = 1;           // 实例ID
    int64 count = 2;        // 删除时的数量
}

// 道具变化结果集合
message ItemChangeResult {
    repeated ItemBase added = 1;        // 新增的道具列表
    repeated ItemChanged changed = 2;   // 数量变化的道具列表
    repeated ItemDeleted deleted = 3;   // 删除的道具列表
}
